!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.EasyQuery=t():e.EasyQuery=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t}return n(e,[{key:"parse",value:function(t){return e._parse(t,this.options)}}],[{key:"_parse",value:function(t,r){var n=[],a=!0,u=!1,i=void 0;try{for(var o,l=r.keys[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=o.value,c=e._stringToKeyValues(t,s),f=c.matches;t=c.queryString,Object.keys(f).length>0&&n.push({key:s,matches:f})}}catch(e){u=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(u)throw i}}(t=t.trim()).length>0&&n.push({key:r.default,matches:[{field:r.default.field,values:[t]}]});var y=[],v=!0,p=!1,d=void 0;try{for(var h,g=n[Symbol.iterator]();!(v=(h=g.next()).done);v=!0){var b=h.value,x=!0,m=!1,S=void 0;try{for(var _,k=b.matches[Symbol.iterator]();!(x=(_=k.next()).done);x=!0){var $=_.value,V=e._keyValueToSelector($,b.key);Object.keys(V).length>0&&y.push(V)}}catch(e){m=!0,S=e}finally{try{!x&&k.return&&k.return()}finally{if(m)throw S}}}}catch(e){p=!0,d=e}finally{try{!v&&g.return&&g.return()}finally{if(p)throw d}}return 1==y.length?y[0]:0==y.length?{}:{$and:y}}},{key:"_stringToKeyValues",value:function(t,r){var n=t,a=[],u=r.alias.map(function(e){return"(?:"+e+")"});u=r.alias.join("|");for(var i=new RegExp("(?:\\s*(?:"+u+'):\\s?"([^"]*)"\\s*|\\s*(?:'+u+"):\\s?([^\\s]*)\\s*)","gi"),o=null;o=i.exec(t);){o.index===i.lastIndex&&i.lastIndex++;var l=o[1]?o[1]:o[2];l=e._splitMultiValues(l),a.push({field:r.field,values:l}),n=n.replace(o[0],"")}return{matches:a,queryString:n}}},{key:"_splitMultiValues",value:function(e){return e.split(";")}},{key:"_keyValueToSelector",value:function(t,r){switch(r.type){case"number":return e._numberKeyValueToSelector(t,r);case"text":return e._textKeyValueToSelector(t,r);default:return e._stringKeyValueToSelector(t,r)}}},{key:"_stringKeyValueToSelector",value:function(t,r){var n=[],a=r.opts.caseSensitive?"g":"gi",u=r.field,i=!0,o=!1,l=void 0;try{for(var s,c=t.values[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var f=s.value;f=e._escapeRegExp(f);var y=r.opts.fuzzy?".*"+f+".*":f,v={};v[u]={$regex:y,$options:a},n.push(v)}}catch(e){o=!0,l=e}finally{try{!i&&c.return&&c.return()}finally{if(o)throw l}}return 1==n.length?n[0]:{$or:n}}},{key:"_escapeRegExp",value:function(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"_numberKeyValueToSelector",value:function(e,t){var r=[],n=t.field,a=!0,u=!1,i=void 0;try{for(var o,l=e.values[Symbol.iterator]();!(a=(o=l.next()).done);a=!0){var s=o.value,c="$eq";if(s.startsWith(">=")?(c="$gte",s=s.substring(2)):s.startsWith("<=")?(c="$lte",s=s.substring(2)):s.startsWith(">")?(c="$gt",s=s.substring(1)):s.startsWith("<")?(c="$lt",s=s.substring(1)):s.startsWith("!")&&(c="$ne",s=s.substring(1)),s=Number(s),!isNaN(s)){var f={};f[n]={},f[n][c]=s,r.push(f)}}}catch(e){u=!0,i=e}finally{try{!a&&l.return&&l.return()}finally{if(u)throw i}}return 1==r.length?r[0]:{$or:r}}},{key:"_textKeyValueToSelector",value:function(e,t){return{$text:{$search:e.values.join(" "),$caseSensitive:t.opts.caseSensitive,$diacriticSensitive:t.opts.diacriticSensitive}}}}]),e}();t.default=a}])});
//# sourceMappingURL=easy-query-dsl.min.js.map
